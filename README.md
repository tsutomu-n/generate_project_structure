
# generate_project_structure.sh

📝 Git リポジトリのファイル構造を Markdown で出力するスクリプト 📂。 `tree` コマンドがあればそれを利用、なければ Bash でツリーを生成。

## 目的

このスクリプトは、Git で管理されているプロジェクトのファイル構造を、 Markdown 形式で出力することを目的としています。これにより、以下のメリットがあります。

*   **プロジェクトの全体像の把握:** 新規メンバーや久しぶりにプロジェクトに戻ってきたメンバーが、ファイル構造を素早く理解できます。
*   **ドキュメントの自動生成:** 生成されたファイル構造を、プロジェクトのドキュメントの一部として利用できます。
*   **コードレビューの効率化:** ファイル構造を参照することで、変更の影響範囲を把握しやすくなります。
*   **リファクタリングの支援:** ファイル構造を視覚化することで、リファクタリングの必要性を検討できます。

特に、以下のような状況で有用です。

*   大規模なプロジェクト
*   オープンソースプロジェクト
*   継続的インテグレーション/継続的デリバリー (CI/CD) 環境

## 依存関係

*   `bash`
*   `git`
*   `tree` (オプション。なければ Bash で代替)
*   `sort`, `mktemp` (通常、Unix/Linux システムに標準でインストールされています)

## 使い方
1.  **配置:** スクリプト (`generate_project_structure.sh`) を、対象となる Git リポジトリのルートディレクトリに配置します。
    (または.scripts/のようなサブディレクトリを作ってそこに配置)

2.  **実行権限の付与:**
    ```bash
    chmod +x generate_project_structure.sh
    (サブディレクトリに配置した場合はchmod +x .scripts/generate_project_structure.sh)
    ```

3.  **実行:**
   ```bash
    ./generate_project_structure.sh
     (サブディレクトリに配置した場合は./.scripts/generate_project_structure.sh)
   ```

4.  **出力:** プロジェクトのルートディレクトリにある`.cursor/rules/structure.mdc`にファイル構造が出力されます。

## 詳細な動作

1.  **環境判定:** Windows (PowerShell または WSL) か Unix/Linux 環境かを判定し、パス区切り文字などを適切に設定します。
2.  **出力ファイル準備:** `.cursor/rules/structure.mdc` を作成/上書きし、Markdown ヘッダーなどを書き込みます。
3.  **`tree` コマンドチェック:** `tree` コマンドが利用可能か確認します。
4.  **ファイル構造取得 & 書き込み:**
    *   **`tree` 利用可能:** `git ls-files` と `tree` コマンドを組み合わせて、ツリー形式のファイル構造を `.cursor/rules/structure.mdc` に出力します。
    *   **`tree` 利用不可:** Bash スクリプトでファイル構造を解析し、簡易的なツリー形式で `.cursor/rules/structure.mdc` に出力します。
5.  **後処理:** Markdown のコードブロックを閉じ、一時ファイルを削除します。

## 注意点
* スクリプトは、Git リポジトリのルートディレクトリで実行することを想定しています。
* 各コマンドの実行結果をチェックし、失敗した場合はエラーメッセージを表示して終了します。
* より移植性の高いshebangとして、`#!/usr/bin/env bash`を使用しています。
